<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Final Report</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Project Overview</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="video.html">Screencast</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="data.html">Data</a>
</li>
<li>
  <a href="https://jagjit-singh.shinyapps.io/spatial/">Shiny App</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Trends over time</li>
    <li class="dropdown-header">Health Factor &amp; SES </li>
    <li class="dropdown-header">Autoregressive Trends</li>
    <li>
      <a href="spatial_maps.html">Spatial Trends</a>
    </li>
  </ul>
</li>
<li>
  <a href="mailto:&lt;js5958@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/jsingh-604/p8105_final_project/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Final Report</h1>

</div>


<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>In 2020, the world entered into a pandemic and now two years later as
we recover and try to move on with life, things are different. The
pandemic brought with it a new lens that showed disparities based on
SES, geographical location, etc. that always existed but were never
taken seriously. Research has shown that people of color and those from
a low SES are at higher risk to contracting COVID-19; as such, public
health professionals should be aware of such gaps and make it an effort
to especially focus on these groups at higher risk (Khanijahani et al.,
2021).</p>
</div>
<div id="analysis-and-relevance" class="section level2">
<h2>Analysis and Relevance:</h2>
<p>Our project looks at the change in COVID-19 trends in New York State
for each county, specifically how COVID-19 is spatially autocorrelated
across the different counties and the extent auto-correlation within New
York City, the most populated county. We also looked at whether health
behaviors and socioeconomic (SES) factors are associated with this
change in trends by county. These analyses can be helpful to public
health officials in the following ways:</p>
<p>First, understanding the spatial patterns of COVID-19 trends can help
public health officials to identify areas that are at higher risk for
the spread of the virus. This information can be used to target
interventions and resources to these areas in order to reduce the spread
of COVID-19 and protect the health of the population.</p>
<p>Second, examining the relationship between health behaviors and SES
factors and the change in COVID-19 trend can help public health
officials to identify potential risk factors for the spread of the
virus. This information can be used to develop targeted interventions
and policies that aim to reduce the risk of COVID-19 transmission by
addressing these factors.</p>
<p>Overall, studying the change in COVID-19 trend in New York State for
each county, and examining spatial autocorrelation and the relationship
with health behaviors and SES factors, can provide valuable insights.
These discoveries can help public health officials to better understand
the spread of COVID-19 and take effective action to reduce the risk of
transmission in communities at higher risk and address presisting health
disparities.</p>
</div>
<div id="data-processing-and-cleaning" class="section level2">
<h2>Data Processing and Cleaning</h2>
<div id="data-sources" class="section level3">
<h3>Data Sources</h3>
<p>Our data were downloaded from three different sources:</p>
<ol style="list-style-type: decimal">
<li><p><strong>New York State Demographics</strong>: US Census Bureau’s
demographics data were imported using <code>tidycensus</code>.</p></li>
<li><p><strong>New York State Health Ranking</strong> <a
href="https://www.countyhealthrankings.org/explore-health-rankings/new-york/data-and-resources">(dataset)</a>:
Four data sets (2019, 2020, 2021 and 2022 New York State Health Ranking
Data) were downloaded as .xls/xlsx. These data sets are provided by the
University of Wisconsin Population Health Institute, which performs
extensive analyses to calculate each New York county’s score for health
factors (health behaviors, clinical care, SES factors, and physical
environment) and health outcome (quality of life, and length of
life).</p></li>
<li><p><strong>New York State COVID-19</strong> <a
href="https://data.ny.gov/browse?tags=covid-19">(dataset)</a>: Three
data sets (COVID testing, COVID vaccination, COVID fatalities from 2020
to 11/2022) were downloaded as .csv.</p></li>
</ol>
</div>
<div id="data-cleaning" class="section level3">
<h3>Data Cleaning</h3>
<ol style="list-style-type: decimal">
<li><strong>New York State Demographics</strong><br />
We imported US Census Bureau’s 2020 data because 2021 data is not
available until 12/8/2022. As demographics data do not change
significantly each year, 2020 data were used for analysis. Then we
decided to include the following variables, as we would like to adjust
them in our models:</li>
</ol>
<ul>
<li>total population in each county (tpop)</li>
<li>median age in each county (medage)</li>
<li>racial diversity index (race_div): calculated Simpson’s Diversity
Index in lines 65 to 69 (higher index indicates more racial
diversity)</li>
</ul>
<pre class="r"><code>census_api_key(&quot;aa512886c5449a582d837da8d3a07af66a043fe5&quot;)

census_data &lt;- load_variables(2020, &quot;acs5&quot;, cache=T)
fwrite(census_data, &quot;census_variables.csv&quot;)

vars &lt;- c(tpop = &#39;P001001&#39;,
          medage = &#39;P013001&#39;,
          wpop = &#39;P003002&#39;,
          bpop = &#39;P003003&#39;,
          apop = &#39;P003005&#39;,
          hpop = &#39;P004003&#39;)

nys_df &lt;- get_decennial(state = &quot;ny&quot;, 
                       geography = &quot;county&quot;,
                       variables = vars,
                       geometry = T,
                       output = &quot;wide&quot;)

NY_df &lt;- get_decennial(state = &quot;ny&quot;, 
                       geography = &quot;county&quot;,
                       variables = vars,
                       geometry = T,
                       output = &quot;wide&quot;)

NY_df = NY_df %&gt;%
  mutate(
    county = gsub(&quot; County, New York&quot;,&quot;&quot;,NAME))

nys_df = nys_df %&gt;%
  mutate(
    county = gsub(&quot; County, New York&quot;,&quot;&quot;,NAME))

nys_df$race_div &lt;- 1 - (((nys_df$wpop*(nys_df$wpop-1))+
                          (nys_df$bpop*(nys_df$bpop-1))+
                          (nys_df$hpop*(nys_df$hpop-1))+
                          (nys_df$apop*(nys_df$apop-1)))/
                         (nys_df$tpop*(nys_df$tpop-1)))

nys_df = nys_df %&gt;% 
  select(tpop, medage, county, race_div)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><strong>New York State Health Ranking</strong><br />
Same steps were taken for each year: As the original excel files contain
multiple sheets. We only imported the sheets that contain variables of
interest.<br />
<br>Each county’s health ranking was imported from the sheet named
“Outcomes &amp; Factors SubRankings.” From the sheet, only the following
variables were selected for future analysis: each county’s rank for
health outcomes (quality of life, renamed to qol_r; length of life,
renamed to longevity_r), health factors (health behaviors, renamed to
health_beh_r; clinical_care, renamed to clinical_care_r; socioeconomic
factors, renamed to ses_r; physical environment, renamed to env_r).
<br>Additionally, further information on each county’s socioeconomic
factors and race/ethnicity were imported from the sheet named
“Additional Measure Data.” The following variables were selected: each
county’s segregation index (white vs. nonwhite), renamed to
segregation_score; median household income, renamed household_income; %
hispanic, p_hispanic; % black, renamed p_black). As we are interested in
observing racial and socioeconomic disparities in COVID, we then created
the following variables: % minority (hispanic + black), named
p_minority; binary variable for low vs. moderate/high level of
segregation. The cutoff value for level of segregation was set as 30. <a
href="https://www1.udel.edu/uapp800/Lecture%20Material/Index%20of%20Dissimilarity%20Example.htm">(source)</a></li>
</ol>
<pre class="r"><code># 2019 HR Data

hr2019 = read_excel(&#39;data/ny_hr19.xls&#39;, sheet = &#39;Outcomes &amp; Factors SubRankings&#39;, skip = 1) %&gt;% 
  janitor::clean_names() %&gt;% 
  slice(-c(1)) %&gt;% 
  select(-starts_with(&quot;z&quot;), -fips, -state) %&gt;% 
  rename(longevity_r = rank_5,
         qol_r = rank_7,
         health_beh_r = rank_9,
         clinical_care_r = rank_11,
         ses_r = rank_13,
         env_r = rank_15)

demo2019 = read_excel(&#39;data/ny_hr19.xls&#39;, sheet = &#39;Additional Measure Data&#39;, skip = 1) %&gt;% 
  janitor::clean_names() %&gt;% 
  slice(-c(1)) %&gt;% 
  select(&#39;county&#39;, 
         &#39;segregation_index_2&#39;,
         &#39;household_income&#39;,
         &#39;percent_hispanic&#39;,
         &#39;percent_african_american&#39;) %&gt;% 
  rename(median_income = household_income,
         segregation_score = segregation_index_2,
         p_hispanic = percent_hispanic,
         p_black = percent_african_american) %&gt;%
    mutate(segregation = case_when(segregation_score &lt; 30 ~ 0,
                                 segregation_score &gt;= 30 ~ 1),
           p_minority = p_black + p_hispanic)

total2019 = merge(x = hr2019, y = demo2019, by = &quot;county&quot;, all.x = TRUE) %&gt;% 
  mutate(year = 2019)

# 2020 HR Data
hr2020 = read_excel(&#39;data/ny_hr20.xlsx&#39;, sheet = &#39;Outcomes &amp; Factors SubRankings&#39;, skip = 1) %&gt;% 
  janitor::clean_names() %&gt;% 
  slice(-c(1)) %&gt;% 
  select(-starts_with(&quot;z&quot;), -fips, -state) %&gt;% 
  rename(longevity_r = rank_5,
         qol_r = rank_7,
         health_beh_r = rank_9,
         clinical_care_r = rank_11,
         ses_r = rank_13,
         env_r = rank_15)

demo2020 = read_excel(&#39;data/ny_hr20.xlsx&#39;, sheet = &#39;Additional Measure Data&#39;, skip = 1) %&gt;% 
  janitor::clean_names() %&gt;% 
  slice(-c(1)) %&gt;% 
  select(&#39;county&#39;, 
         &#39;median_household_income&#39;, 
         &#39;segregation_index_2&#39;,
         &#39;percent_black&#39;,
         &#39;percent_hispanic&#39;) %&gt;% 
  rename(median_income = median_household_income, 
         segregation_score = segregation_index_2,
         p_black = percent_black,
         p_hispanic = percent_hispanic) %&gt;% 
    mutate(segregation = case_when(segregation_score &lt; 30 ~ 0,
                                 segregation_score &gt;= 30 ~ 1),
           p_minority = p_black + p_hispanic)

total2020 = merge(x = hr2020, y = demo2020, by = &quot;county&quot;, all.x = TRUE) %&gt;% 
  mutate(year = 2020)

# 2021 HR Data
hr2021 = read_excel(&#39;data/ny_hr21.xlsx&#39;, sheet = &#39;Outcomes &amp; Factors SubRankings&#39;, skip = 1) %&gt;% 
  janitor::clean_names() %&gt;% 
  slice(-c(1)) %&gt;% 
  select(-starts_with(&quot;z&quot;), -fips, -state) %&gt;% 
  rename(longevity_r = rank_5,
         qol_r = rank_7,
         health_beh_r = rank_9,
         clinical_care_r = rank_11,
         ses_r = rank_13,
         env_r = rank_15)

demo2021 = read_excel(&#39;data/ny_hr21.xlsx&#39;, sheet = &#39;Additional Measure Data&#39;, skip = 1) %&gt;% 
  janitor::clean_names() %&gt;% 
  slice(-c(1)) %&gt;% 
  select(&#39;county&#39;, 
         &#39;median_household_income&#39;, 
         &#39;segregation_index_2&#39;,
         &#39;percent_black&#39;,
         &#39;percent_hispanic&#39;) %&gt;% 
  rename(median_income = median_household_income, 
         segregation_score = segregation_index_2,
         p_black = percent_black,
         p_hispanic = percent_hispanic) %&gt;% 
    mutate(segregation = case_when(segregation_score &lt; 30 ~ 0,
                                 segregation_score &gt;= 30 ~ 1),
           p_minority = p_black + p_hispanic)

total2021 = merge(x = hr2021, y = demo2021, by = &quot;county&quot;, all.x = TRUE) %&gt;%
  mutate(year = 2021)

# 2022 HR Data
hr2022 = read_excel(&#39;data/ny_hr22.xlsx&#39;, sheet = &#39;Outcomes &amp; Factors SubRankings&#39;, skip = 1) %&gt;% 
  janitor::clean_names() %&gt;% 
  slice(-c(1)) %&gt;% 
  select(-starts_with(&quot;z&quot;), -fips, -state) %&gt;% 
  rename(longevity_r = rank_5,
         qol_r = rank_7,
         health_beh_r = rank_9,
         clinical_care_r = rank_11,
         ses_r = rank_13,
         env_r = rank_15)

demo2022 = read_excel(&#39;data/ny_hr22.xlsx&#39;, sheet = &#39;Additional Measure Data&#39;, skip = 1) %&gt;% 
  janitor::clean_names() %&gt;% 
  slice(-c(1)) %&gt;% 
    select(&#39;county&#39;, 
         &#39;median_household_income&#39;, 
         &#39;segregation_index&#39;,
         &#39;percent_black&#39;,
         &#39;percent_hispanic&#39;) %&gt;% 
  rename(median_income = median_household_income, 
         segregation_score = segregation_index,
         p_black = percent_black,
         p_hispanic = percent_hispanic) %&gt;% 
    mutate(segregation = case_when(segregation_score &lt; 30 ~ 0,
                                 segregation_score &gt;= 30 ~ 1),
           p_minority = p_hispanic + p_black)

total2022 = merge(x = hr2022, y = demo2022, by = &quot;county&quot;, all.x = TRUE) %&gt;% 
  mutate(year = 2022)

# Merge
hr_all = rbind(total2019, total2020, total2021, total2022)</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><strong>New York State COVID-19</strong><br />
From the three data sets we extracted the following variables of
interest: number of new COVID cases per day, cumulative number of deaths
reported per day, cumulative # of individuals who received the first
dose of the vaccine. For the data set with cumulative number of deaths,
the county “Manhattan” was replaced with “New York” for consistency.
Next, the three data sets were merged by “date” and “county.” The merged
data set was then grouped according to “county” and “year” and the
following variables were created: total number of new positive cases per
year, called n_cases; total number of deaths per year, called n_deaths;
and total number of individuals who received the first dose of the
vaccine per year, called vax_dose1 (this data is not available for year
2020).</li>
</ol>
<pre class="r"><code>ny_test = read_csv(&#39;data/ny_covidtest.csv&#39;) %&gt;% 
janitor::clean_names() %&gt;% 
filter(geography == &#39;COUNTY&#39;) %&gt;% 
select(-geography) %&gt;% 
rename(date = test_date) %&gt;% 
mutate(date = lubridate::mdy(date))  

ny_death = read_csv(&quot;data/ny_coviddeaths.csv&quot;) %&gt;% 
janitor::clean_names() %&gt;% 
rename(date = report_date, n_fatality = place_of_fatality) %&gt;%
select(-deaths_by_county_of_residence) %&gt;% 
mutate(date = lubridate::mdy(date), county = replace(county, county == &#39;Manhattan&#39;, &#39;New York&#39;))

ny_vax = read_csv(&quot;data/ny_covidvax.csv&quot;) %&gt;% 
janitor::clean_names() %&gt;% 
rename(date = report_as_of) %&gt;% 
select(-region, -series_complete) %&gt;% 
mutate(date = lubridate::mdy(date))

ny_covid_v1 = left_join(ny_test, ny_death, by = c(&quot;date&quot;, &quot;county&quot;))

covid_df_v1 = left_join(ny_covid_v1, ny_vax, by = c(&quot;date&quot;, &quot;county&quot;)) %&gt;% 
  separate(date, c(&quot;year&quot;, &quot;month&quot;, &quot;day&quot;), sep = &quot;-&quot;) %&gt;% 
  mutate(year = as.numeric(year), month = as.numeric(month), day = as.numeric(day))

covid_df = covid_df_v1 %&gt;% 
  group_by(year, county) %&gt;% 
  summarise(n_cases = sum(new_positives),
            vax_dose1 = max(first_dose),
            n_deaths = max(n_fatality, na.rm = TRUE))</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><strong>Dataset for Analysis</strong><br />
For regression tests, demographics dataset, HR dataset, and COVID
dataset were all merged into one dataset called “comb.” At the end, we
added a new binary variable called vax_maj to see whether majority of
the residents in the county had received the first dose of vaccine. The
cutoff value used was 83% as it was reported that nearly ~83% of the
state of New York residents had completed at least one dose of vaccine
by the end of 2021. <a
href="https://data.democratandchronicle.com/covid-19-vaccine-tracker/new-york/36/.">(source)</a></li>
</ol>
<pre class="r"><code>covid_hr = left_join(covid_df, hr_all, by = c(&quot;county&quot;, &quot;year&quot;)) 
comb = left_join(covid_hr, nys_df, by = &#39;county&#39;) %&gt;% 
  mutate(tpop_50 = tpop/2,
         vax_maj = case_when(vax_dose1 &gt;= .83*(tpop) ~ 1,
                             vax_dose1 &lt; .83*(tpop) ~ 0))</code></pre>
</div>
</div>
<div id="exploratory-data-analysis" class="section level2">
<h2>Exploratory Data Analysis</h2>
<p>In order to have a better understanding of the existing socioeconomic
and health factor status of the counties we conducted some exploratory
data analysis mainly through visualization. We first tried to see which
counties have the highest socio-economic and heath factor scores</p>
<pre class="r"><code>library(plotly)
data = read.csv(&quot;./data/bubble.csv&quot;) %&gt;%
  mutate(County = as.factor(County),
         health = as.numeric(health),
         socio = as.numeric(socio)) %&gt;%
  janitor::clean_names()


total &lt;- merge(data,NY_df,by=&quot;county&quot;)

fig &lt;- plot_ly(total, x = ~health, y = ~socio, text = ~county, type = &#39;scatter&#39;,
               mode = &#39;markers&#39;, size = ~tpop, color = ~county, colors = &#39;Paired&#39;,
               marker = list(opacity = 0.5, sizemode = &#39;diameter&#39;))
fig &lt;- fig %&gt;% layout(title = &#39;health-socio&#39;,
                      xaxis = list(showgrid = FALSE),
                      yaxis = list(showgrid = FALSE),
                      showlegend = FALSE)

fig</code></pre>
<div id="htmlwidget-0715fc3f5150d53edbcf" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-0715fc3f5150d53edbcf">{"x":{"visdat":{"bb802d667d27":["function () ","plotlyVisDat"]},"cur_data":"bb802d667d27","attrs":{"bb802d667d27":{"x":{},"y":{},"text":{},"mode":"markers","marker":{"opacity":0.5,"sizemode":"diameter"},"color":{},"size":{},"colors":"Paired","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"health-socio","xaxis":{"domain":[0,1],"automargin":true,"showgrid":false,"title":"health"},"yaxis":{"domain":[0,1],"automargin":true,"showgrid":false,"title":"socio"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[12],"y":[6],"text":"Albany","mode":"markers","marker":{"color":"rgba(166,206,227,1)","size":[20.7778343141867],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(166,206,227,1)"}},"type":"scatter","name":"Albany","textfont":{"color":"rgba(166,206,227,1)","size":20.7778343141867},"error_y":{"color":"rgba(166,206,227,1)","width":20.7778343141867},"error_x":{"color":"rgba(166,206,227,1)","width":20.7778343141867},"line":{"color":"rgba(166,206,227,1)","width":20.7778343141867},"xaxis":"x","yaxis":"y","frame":null},{"x":[53],"y":[24],"text":"Allegany","mode":"markers","marker":{"color":"rgba(146,190,219,1)","size":[11.5880463897236],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(146,190,219,1)"}},"type":"scatter","name":"Allegany","textfont":{"color":"rgba(146,190,219,1)","size":11.5880463897236},"error_y":{"color":"rgba(146,190,219,1)","width":11.5880463897236},"error_x":{"color":"rgba(146,190,219,1)","width":11.5880463897236},"line":{"color":"rgba(146,190,219,1)","width":11.5880463897236},"xaxis":"x","yaxis":"y","frame":null},{"x":[43],"y":[62],"text":"Bronx","mode":"markers","marker":{"color":"rgba(126,174,210,1)","size":[59.6924952717428],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(126,174,210,1)"}},"type":"scatter","name":"Bronx","textfont":{"color":"rgba(126,174,210,1)","size":59.6924952717428},"error_y":{"color":"rgba(126,174,210,1)","width":59.6924952717428},"error_x":{"color":"rgba(126,174,210,1)","width":59.6924952717428},"line":{"color":"rgba(126,174,210,1)","width":59.6924952717428},"xaxis":"x","yaxis":"y","frame":null},{"x":[26],"y":[54],"text":"Broome","mode":"markers","marker":{"color":"rgba(104,158,202,1)","size":[17.0478874050748],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(104,158,202,1)"}},"type":"scatter","name":"Broome","textfont":{"color":"rgba(104,158,202,1)","size":17.0478874050748},"error_y":{"color":"rgba(104,158,202,1)","width":17.0478874050748},"error_x":{"color":"rgba(104,158,202,1)","width":17.0478874050748},"line":{"color":"rgba(104,158,202,1)","width":17.0478874050748},"xaxis":"x","yaxis":"y","frame":null},{"x":[56],"y":[55],"text":"Cattaraugus","mode":"markers","marker":{"color":"rgba(81,143,193,1)","size":[12.7174638300324],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(81,143,193,1)"}},"type":"scatter","name":"Cattaraugus","textfont":{"color":"rgba(81,143,193,1)","size":12.7174638300324},"error_y":{"color":"rgba(81,143,193,1)","width":12.7174638300324},"error_x":{"color":"rgba(81,143,193,1)","width":12.7174638300324},"line":{"color":"rgba(81,143,193,1)","width":12.7174638300324},"xaxis":"x","yaxis":"y","frame":null},{"x":[52],"y":[37],"text":"Cayuga","mode":"markers","marker":{"color":"rgba(53,128,185,1)","size":[12.7069872601069],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(53,128,185,1)"}},"type":"scatter","name":"Cayuga","textfont":{"color":"rgba(53,128,185,1)","size":12.7069872601069},"error_y":{"color":"rgba(53,128,185,1)","width":12.7069872601069},"error_x":{"color":"rgba(53,128,185,1)","width":12.7069872601069},"line":{"color":"rgba(53,128,185,1)","width":12.7069872601069},"xaxis":"x","yaxis":"y","frame":null},{"x":[57],"y":[44],"text":"Chautauqua","mode":"markers","marker":{"color":"rgba(58,128,177,1)","size":[14.6827387409875],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(58,128,177,1)"}},"type":"scatter","name":"Chautauqua","textfont":{"color":"rgba(58,128,177,1)","size":14.6827387409875},"error_y":{"color":"rgba(58,128,177,1)","width":14.6827387409875},"error_x":{"color":"rgba(58,128,177,1)","width":14.6827387409875},"line":{"color":"rgba(58,128,177,1)","width":14.6827387409875},"xaxis":"x","yaxis":"y","frame":null},{"x":[50],"y":[50],"text":"Chemung","mode":"markers","marker":{"color":"rgba(93,145,171,1)","size":[13.0239485027986],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(93,145,171,1)"}},"type":"scatter","name":"Chemung","textfont":{"color":"rgba(93,145,171,1)","size":13.0239485027986},"error_y":{"color":"rgba(93,145,171,1)","width":13.0239485027986},"error_x":{"color":"rgba(93,145,171,1)","width":13.0239485027986},"line":{"color":"rgba(93,145,171,1)","width":13.0239485027986},"xaxis":"x","yaxis":"y","frame":null},{"x":[51],"y":[25],"text":"Chenango","mode":"markers","marker":{"color":"rgba(118,164,164,1)","size":[11.6431653881971],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(118,164,164,1)"}},"type":"scatter","name":"Chenango","textfont":{"color":"rgba(118,164,164,1)","size":11.6431653881971},"error_y":{"color":"rgba(118,164,164,1)","width":11.6431653881971},"error_x":{"color":"rgba(118,164,164,1)","width":11.6431653881971},"line":{"color":"rgba(118,164,164,1)","width":11.6431653881971},"xaxis":"x","yaxis":"y","frame":null},{"x":[38],"y":[30],"text":"Clinton","mode":"markers","marker":{"color":"rgba(139,182,157,1)","size":[12.7826633768877],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(139,182,157,1)"}},"type":"scatter","name":"Clinton","textfont":{"color":"rgba(139,182,157,1)","size":12.7826633768877},"error_y":{"color":"rgba(139,182,157,1)","width":12.7826633768877},"error_x":{"color":"rgba(139,182,157,1)","width":12.7826633768877},"line":{"color":"rgba(139,182,157,1)","width":12.7826633768877},"xaxis":"x","yaxis":"y","frame":null},{"x":[17],"y":[17],"text":"Columbia","mode":"markers","marker":{"color":"rgba(159,202,148,1)","size":[12.0974741025912],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(159,202,148,1)"}},"type":"scatter","name":"Columbia","textfont":{"color":"rgba(159,202,148,1)","size":12.0974741025912},"error_y":{"color":"rgba(159,202,148,1)","width":12.0974741025912},"error_x":{"color":"rgba(159,202,148,1)","width":12.0974741025912},"line":{"color":"rgba(159,202,148,1)","width":12.0974741025912},"xaxis":"x","yaxis":"y","frame":null},{"x":[36],"y":[20],"text":"Cortland","mode":"markers","marker":{"color":"rgba(176,221,139,1)","size":[11.6020871535412],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(176,221,139,1)"}},"type":"scatter","name":"Cortland","textfont":{"color":"rgba(176,221,139,1)","size":11.6020871535412},"error_y":{"color":"rgba(176,221,139,1)","width":11.6020871535412},"error_x":{"color":"rgba(176,221,139,1)","width":11.6020871535412},"line":{"color":"rgba(176,221,139,1)","width":11.6020871535412},"xaxis":"x","yaxis":"y","frame":null},{"x":[39],"y":[36],"text":"Delaware","mode":"markers","marker":{"color":"rgba(159,213,123,1)","size":[11.5532684978063],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(159,213,123,1)"}},"type":"scatter","name":"Delaware","textfont":{"color":"rgba(159,213,123,1)","size":11.5532684978063},"error_y":{"color":"rgba(159,213,123,1)","width":11.5532684978063},"error_x":{"color":"rgba(159,213,123,1)","width":11.5532684978063},"line":{"color":"rgba(159,213,123,1)","width":11.5532684978063},"xaxis":"x","yaxis":"y","frame":null},{"x":[15],"y":[14],"text":"Dutchess","mode":"markers","marker":{"color":"rgba(138,201,106,1)","size":[20.5360451608568],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(138,201,106,1)"}},"type":"scatter","name":"Dutchess","textfont":{"color":"rgba(138,201,106,1)","size":20.5360451608568},"error_y":{"color":"rgba(138,201,106,1)","width":20.5360451608568},"error_x":{"color":"rgba(138,201,106,1)","width":20.5360451608568},"line":{"color":"rgba(138,201,106,1)","width":20.5360451608568},"xaxis":"x","yaxis":"y","frame":null},{"x":[23],"y":[43],"text":"Erie","mode":"markers","marker":{"color":"rgba(117,190,89,1)","size":[42.9131344745154],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(117,190,89,1)"}},"type":"scatter","name":"Erie","textfont":{"color":"rgba(117,190,89,1)","size":42.9131344745154},"error_y":{"color":"rgba(117,190,89,1)","width":42.9131344745154},"error_x":{"color":"rgba(117,190,89,1)","width":42.9131344745154},"line":{"color":"rgba(117,190,89,1)","width":42.9131344745154},"xaxis":"x","yaxis":"y","frame":null},{"x":[22],"y":[23],"text":"Essex","mode":"markers","marker":{"color":"rgba(94,179,73,1)","size":[11.2432916350649],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(94,179,73,1)"}},"type":"scatter","name":"Essex","textfont":{"color":"rgba(94,179,73,1)","size":11.2432916350649},"error_y":{"color":"rgba(94,179,73,1)","width":11.2432916350649},"error_x":{"color":"rgba(94,179,73,1)","width":11.2432916350649},"line":{"color":"rgba(94,179,73,1)","width":11.2432916350649},"xaxis":"x","yaxis":"y","frame":null},{"x":[62],"y":[58],"text":"Franklin","mode":"markers","marker":{"color":"rgba(69,167,56,1)","size":[11.6835595856415],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(69,167,56,1)"}},"type":"scatter","name":"Franklin","textfont":{"color":"rgba(69,167,56,1)","size":11.6835595856415},"error_y":{"color":"rgba(69,167,56,1)","width":11.6835595856415},"error_x":{"color":"rgba(69,167,56,1)","width":11.6835595856415},"line":{"color":"rgba(69,167,56,1)","width":11.6835595856415},"xaxis":"x","yaxis":"y","frame":null},{"x":[55],"y":[52],"text":"Fulton","mode":"markers","marker":{"color":"rgba(73,161,52,1)","size":[11.8251192864892],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(73,161,52,1)"}},"type":"scatter","name":"Fulton","textfont":{"color":"rgba(73,161,52,1)","size":11.8251192864892},"error_y":{"color":"rgba(73,161,52,1)","width":11.8251192864892},"error_x":{"color":"rgba(73,161,52,1)","width":11.8251192864892},"line":{"color":"rgba(73,161,52,1)","width":11.8251192864892},"xaxis":"x","yaxis":"y","frame":null},{"x":[31],"y":[13],"text":"Genesee","mode":"markers","marker":{"color":"rgba(117,162,73,1)","size":[11.9888561937769],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(117,162,73,1)"}},"type":"scatter","name":"Genesee","textfont":{"color":"rgba(117,162,73,1)","size":11.9888561937769},"error_y":{"color":"rgba(117,162,73,1)","width":11.9888561937769},"error_x":{"color":"rgba(117,162,73,1)","width":11.9888561937769},"line":{"color":"rgba(117,162,73,1)","width":11.9888561937769},"xaxis":"x","yaxis":"y","frame":null},{"x":[41],"y":[47],"text":"Greene","mode":"markers","marker":{"color":"rgba(152,163,93,1)","size":[11.5979469283129],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(152,163,93,1)"}},"type":"scatter","name":"Greene","textfont":{"color":"rgba(152,163,93,1)","size":11.5979469283129},"error_y":{"color":"rgba(152,163,93,1)","width":11.5979469283129},"error_x":{"color":"rgba(152,163,93,1)","width":11.5979469283129},"line":{"color":"rgba(152,163,93,1)","width":11.5979469283129},"xaxis":"x","yaxis":"y","frame":null},{"x":[45],"y":[33],"text":"Hamilton","mode":"markers","marker":{"color":"rgba(184,162,112,1)","size":[10],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(184,162,112,1)"}},"type":"scatter","name":"Hamilton","textfont":{"color":"rgba(184,162,112,1)","size":10},"error_y":{"color":"rgba(184,162,112,1)","width":10},"error_x":{"color":"rgba(184,162,112,1)","width":10},"line":{"color":"rgba(184,162,112,1)","width":10},"xaxis":"x","yaxis":"y","frame":null},{"x":[44],"y":[26],"text":"Herkimer","mode":"markers","marker":{"color":"rgba(215,159,131,1)","size":[12.148704889546],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(215,159,131,1)"}},"type":"scatter","name":"Herkimer","textfont":{"color":"rgba(215,159,131,1)","size":12.148704889546},"error_y":{"color":"rgba(215,159,131,1)","width":12.148704889546},"error_x":{"color":"rgba(215,159,131,1)","width":12.148704889546},"line":{"color":"rgba(215,159,131,1)","width":12.148704889546},"xaxis":"x","yaxis":"y","frame":null},{"x":[61],"y":[35],"text":"Jefferson","mode":"markers","marker":{"color":"rgba(246,155,150,1)","size":[14.0103661639193],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(246,155,150,1)"}},"type":"scatter","name":"Jefferson","textfont":{"color":"rgba(246,155,150,1)","size":14.0103661639193},"error_y":{"color":"rgba(246,155,150,1)","width":14.0103661639193},"error_x":{"color":"rgba(246,155,150,1)","width":14.0103661639193},"line":{"color":"rgba(246,155,150,1)","width":14.0103661639193},"xaxis":"x","yaxis":"y","frame":null},{"x":[8],"y":[61],"text":"Kings","mode":"markers","marker":{"color":"rgba(250,139,134,1)","size":[100],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(250,139,134,1)"}},"type":"scatter","name":"Kings","textfont":{"color":"rgba(250,139,134,1)","size":100},"error_y":{"color":"rgba(250,139,134,1)","width":100},"error_x":{"color":"rgba(250,139,134,1)","width":100},"line":{"color":"rgba(250,139,134,1)","width":100},"xaxis":"x","yaxis":"y","frame":null},{"x":[59],"y":[21],"text":"Lewis","mode":"markers","marker":{"color":"rgba(247,120,111,1)","size":[10.8010795787291],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(247,120,111,1)"}},"type":"scatter","name":"Lewis","textfont":{"color":"rgba(247,120,111,1)","size":10.8010795787291},"error_y":{"color":"rgba(247,120,111,1)","width":10.8010795787291},"error_x":{"color":"rgba(247,120,111,1)","width":10.8010795787291},"line":{"color":"rgba(247,120,111,1)","width":10.8010795787291},"xaxis":"x","yaxis":"y","frame":null},{"x":[19],"y":[7],"text":"Livingston","mode":"markers","marker":{"color":"rgba(243,101,89,1)","size":[12.1801706012807],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(243,101,89,1)"}},"type":"scatter","name":"Livingston","textfont":{"color":"rgba(243,101,89,1)","size":12.1801706012807},"error_y":{"color":"rgba(243,101,89,1)","width":12.1801706012807},"error_x":{"color":"rgba(243,101,89,1)","width":12.1801706012807},"line":{"color":"rgba(243,101,89,1)","width":12.1801706012807},"xaxis":"x","yaxis":"y","frame":null},{"x":[27],"y":[18],"text":"Madison","mode":"markers","marker":{"color":"rgba(238,79,67,1)","size":[12.4699503652999],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(238,79,67,1)"}},"type":"scatter","name":"Madison","textfont":{"color":"rgba(238,79,67,1)","size":12.4699503652999},"error_y":{"color":"rgba(238,79,67,1)","width":12.4699503652999},"error_x":{"color":"rgba(238,79,67,1)","width":12.4699503652999},"line":{"color":"rgba(238,79,67,1)","width":12.4699503652999},"xaxis":"x","yaxis":"y","frame":null},{"x":[21],"y":[45],"text":"Monroe","mode":"markers","marker":{"color":"rgba(232,54,45,1)","size":[36.6237363312564],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(232,54,45,1)"}},"type":"scatter","name":"Monroe","textfont":{"color":"rgba(232,54,45,1)","size":36.6237363312564},"error_y":{"color":"rgba(232,54,45,1)","width":36.6237363312564},"error_x":{"color":"rgba(232,54,45,1)","width":36.6237363312564},"line":{"color":"rgba(232,54,45,1)","width":36.6237363312564},"xaxis":"x","yaxis":"y","frame":null},{"x":[60],"y":[53],"text":"Montgomery","mode":"markers","marker":{"color":"rgba(229,43,32,1)","size":[11.6338768829024],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(229,43,32,1)"}},"type":"scatter","name":"Montgomery","textfont":{"color":"rgba(229,43,32,1)","size":11.6338768829024},"error_y":{"color":"rgba(229,43,32,1)","width":11.6338768829024},"error_x":{"color":"rgba(229,43,32,1)","width":11.6338768829024},"line":{"color":"rgba(229,43,32,1)","width":11.6338768829024},"xaxis":"x","yaxis":"y","frame":null},{"x":[2],"y":[4],"text":"Nassau","mode":"markers","marker":{"color":"rgba(236,81,46,1)","size":[58.0516700108486],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(236,81,46,1)"}},"type":"scatter","name":"Nassau","textfont":{"color":"rgba(236,81,46,1)","size":58.0516700108486},"error_y":{"color":"rgba(236,81,46,1)","width":58.0516700108486},"error_x":{"color":"rgba(236,81,46,1)","width":58.0516700108486},"line":{"color":"rgba(236,81,46,1)","width":58.0516700108486},"xaxis":"x","yaxis":"y","frame":null},{"x":[3],"y":[56],"text":"New York","mode":"markers","marker":{"color":"rgba(242,110,60,1)","size":[66.9204284713088],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(242,110,60,1)"}},"type":"scatter","name":"New York","textfont":{"color":"rgba(242,110,60,1)","size":66.9204284713088},"error_y":{"color":"rgba(242,110,60,1)","width":66.9204284713088},"error_x":{"color":"rgba(242,110,60,1)","width":66.9204284713088},"line":{"color":"rgba(242,110,60,1)","width":66.9204284713088},"xaxis":"x","yaxis":"y","frame":null},{"x":[34],"y":[46],"text":"Niagara","mode":"markers","marker":{"color":"rgba(246,136,75,1)","size":[17.6192024846152],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(246,136,75,1)"}},"type":"scatter","name":"Niagara","textfont":{"color":"rgba(246,136,75,1)","size":17.6192024846152},"error_y":{"color":"rgba(246,136,75,1)","width":17.6192024846152},"error_x":{"color":"rgba(246,136,75,1)","width":17.6192024846152},"line":{"color":"rgba(246,136,75,1)","width":17.6192024846152},"xaxis":"x","yaxis":"y","frame":null},{"x":[49],"y":[41],"text":"Oneida","mode":"markers","marker":{"color":"rgba(250,161,91,1)","size":[18.2819625387621],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(250,161,91,1)"}},"type":"scatter","name":"Oneida","textfont":{"color":"rgba(250,161,91,1)","size":18.2819625387621},"error_y":{"color":"rgba(250,161,91,1)","width":18.2819625387621},"error_x":{"color":"rgba(250,161,91,1)","width":18.2819625387621},"line":{"color":"rgba(250,161,91,1)","width":18.2819625387621},"xaxis":"x","yaxis":"y","frame":null},{"x":[33],"y":[42],"text":"Onondaga","mode":"markers","marker":{"color":"rgba(253,185,107,1)","size":[26.639745202139],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(253,185,107,1)"}},"type":"scatter","name":"Onondaga","textfont":{"color":"rgba(253,185,107,1)","size":26.639745202139},"error_y":{"color":"rgba(253,185,107,1)","width":26.639745202139},"error_x":{"color":"rgba(253,185,107,1)","width":26.639745202139},"line":{"color":"rgba(253,185,107,1)","width":26.639745202139},"xaxis":"x","yaxis":"y","frame":null},{"x":[13],"y":[5],"text":"Ontario","mode":"markers","marker":{"color":"rgba(254,183,100,1)","size":[13.711621912232],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(254,183,100,1)"}},"type":"scatter","name":"Ontario","textfont":{"color":"rgba(254,183,100,1)","size":13.711621912232},"error_y":{"color":"rgba(254,183,100,1)","width":13.711621912232},"error_x":{"color":"rgba(254,183,100,1)","width":13.711621912232},"line":{"color":"rgba(254,183,100,1)","width":13.711621912232},"xaxis":"x","yaxis":"y","frame":null},{"x":[14],"y":[34],"text":"Orange","mode":"markers","marker":{"color":"rgba(255,172,84,1)","size":[23.2478926853621],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(255,172,84,1)"}},"type":"scatter","name":"Orange","textfont":{"color":"rgba(255,172,84,1)","size":23.2478926853621},"error_y":{"color":"rgba(255,172,84,1)","width":23.2478926853621},"error_x":{"color":"rgba(255,172,84,1)","width":23.2478926853621},"line":{"color":"rgba(255,172,84,1)","width":23.2478926853621},"xaxis":"x","yaxis":"y","frame":null},{"x":[46],"y":[48],"text":"Orleans","mode":"markers","marker":{"color":"rgba(255,160,67,1)","size":[11.3697665152984],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(255,160,67,1)"}},"type":"scatter","name":"Orleans","textfont":{"color":"rgba(255,160,67,1)","size":11.3697665152984},"error_y":{"color":"rgba(255,160,67,1)","width":11.3697665152984},"error_x":{"color":"rgba(255,160,67,1)","width":11.3697665152984},"line":{"color":"rgba(255,160,67,1)","width":11.3697665152984},"xaxis":"x","yaxis":"y","frame":null},{"x":[58],"y":[49],"text":"Oswego","mode":"markers","marker":{"color":"rgba(255,149,50,1)","size":[14.2220576799378],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(255,149,50,1)"}},"type":"scatter","name":"Oswego","textfont":{"color":"rgba(255,149,50,1)","size":14.2220576799378},"error_y":{"color":"rgba(255,149,50,1)","width":14.2220576799378},"error_x":{"color":"rgba(255,149,50,1)","width":14.2220576799378},"line":{"color":"rgba(255,149,50,1)","width":14.2220576799378},"xaxis":"x","yaxis":"y","frame":null},{"x":[37],"y":[12],"text":"Otsego","mode":"markers","marker":{"color":"rgba(255,137,29,1)","size":[12.0673404633212],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(255,137,29,1)"}},"type":"scatter","name":"Otsego","textfont":{"color":"rgba(255,137,29,1)","size":12.0673404633212},"error_y":{"color":"rgba(255,137,29,1)","width":12.0673404633212},"error_x":{"color":"rgba(255,137,29,1)","width":12.0673404633212},"line":{"color":"rgba(255,137,29,1)","width":12.0673404633212},"xaxis":"x","yaxis":"y","frame":null},{"x":[6],"y":[2],"text":"Putnam","mode":"markers","marker":{"color":"rgba(254,129,19,1)","size":[13.4156498113497],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(254,129,19,1)"}},"type":"scatter","name":"Putnam","textfont":{"color":"rgba(254,129,19,1)","size":13.4156498113497},"error_y":{"color":"rgba(254,129,19,1)","width":13.4156498113497},"error_x":{"color":"rgba(254,129,19,1)","width":13.4156498113497},"line":{"color":"rgba(254,129,19,1)","width":13.4156498113497},"xaxis":"x","yaxis":"y","frame":null},{"x":[4],"y":[60],"text":"Queens","mode":"markers","marker":{"color":"rgba(250,138,67,1)","size":[90.1362554122944],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(250,138,67,1)"}},"type":"scatter","name":"Queens","textfont":{"color":"rgba(250,138,67,1)","size":90.1362554122944},"error_y":{"color":"rgba(250,138,67,1)","width":90.1362554122944},"error_x":{"color":"rgba(250,138,67,1)","width":90.1362554122944},"line":{"color":"rgba(250,138,67,1)","width":90.1362554122944},"xaxis":"x","yaxis":"y","frame":null},{"x":[20],"y":[10],"text":"Rensselaer","mode":"markers","marker":{"color":"rgba(244,147,103,1)","size":[15.565650771402],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(244,147,103,1)"}},"type":"scatter","name":"Rensselaer","textfont":{"color":"rgba(244,147,103,1)","size":15.565650771402},"error_y":{"color":"rgba(244,147,103,1)","width":15.565650771402},"error_x":{"color":"rgba(244,147,103,1)","width":15.565650771402},"line":{"color":"rgba(244,147,103,1)","width":15.565650771402},"xaxis":"x","yaxis":"y","frame":null},{"x":[10],"y":[57],"text":"Richmond","mode":"markers","marker":{"color":"rgba(236,156,136,1)","size":[26.7010925394341],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(236,156,136,1)"}},"type":"scatter","name":"Richmond","textfont":{"color":"rgba(236,156,136,1)","size":26.7010925394341},"error_y":{"color":"rgba(236,156,136,1)","width":26.7010925394341},"error_x":{"color":"rgba(236,156,136,1)","width":26.7010925394341},"line":{"color":"rgba(236,156,136,1)","width":26.7010925394341},"xaxis":"x","yaxis":"y","frame":null},{"x":[5],"y":[39],"text":"Rockland","mode":"markers","marker":{"color":"rgba(224,166,169,1)","size":[21.0472369696912],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(224,166,169,1)"}},"type":"scatter","name":"Rockland","textfont":{"color":"rgba(224,166,169,1)","size":21.0472369696912},"error_y":{"color":"rgba(224,166,169,1)","width":21.0472369696912},"error_x":{"color":"rgba(224,166,169,1)","width":21.0472369696912},"line":{"color":"rgba(224,166,169,1)","width":21.0472369696912},"xaxis":"x","yaxis":"y","frame":null},{"x":[11],"y":[1],"text":"Saratoga","mode":"markers","marker":{"color":"rgba(209,175,202,1)","size":[17.7321766304087],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(209,175,202,1)"}},"type":"scatter","name":"Saratoga","textfont":{"color":"rgba(209,175,202,1)","size":17.7321766304087},"error_y":{"color":"rgba(209,175,202,1)","width":17.7321766304087},"error_x":{"color":"rgba(209,175,202,1)","width":17.7321766304087},"line":{"color":"rgba(209,175,202,1)","width":17.7321766304087},"xaxis":"x","yaxis":"y","frame":null},{"x":[28],"y":[32],"text":"Schenectady","mode":"markers","marker":{"color":"rgba(191,164,207,1)","size":[15.3963695625042],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(191,164,207,1)"}},"type":"scatter","name":"Schenectady","textfont":{"color":"rgba(191,164,207,1)","size":15.3963695625042},"error_y":{"color":"rgba(191,164,207,1)","width":15.3963695625042},"error_x":{"color":"rgba(191,164,207,1)","width":15.3963695625042},"line":{"color":"rgba(191,164,207,1)","width":15.3963695625042},"xaxis":"x","yaxis":"y","frame":null},{"x":[30],"y":[22],"text":"Schoharie","mode":"markers","marker":{"color":"rgba(174,142,196,1)","size":[11.0049226677931],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(174,142,196,1)"}},"type":"scatter","name":"Schoharie","textfont":{"color":"rgba(174,142,196,1)","size":11.0049226677931},"error_y":{"color":"rgba(174,142,196,1)","width":11.0049226677931},"error_x":{"color":"rgba(174,142,196,1)","width":11.0049226677931},"line":{"color":"rgba(174,142,196,1)","width":11.0049226677931},"xaxis":"x","yaxis":"y","frame":null},{"x":[47],"y":[29],"text":"Schuyler","mode":"markers","marker":{"color":"rgba(157,121,186,1)","size":[10.4862784535479],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(157,121,186,1)"}},"type":"scatter","name":"Schuyler","textfont":{"color":"rgba(157,121,186,1)","size":10.4862784535479},"error_y":{"color":"rgba(157,121,186,1)","width":10.4862784535479},"error_x":{"color":"rgba(157,121,186,1)","width":10.4862784535479},"line":{"color":"rgba(157,121,186,1)","width":10.4862784535479},"xaxis":"x","yaxis":"y","frame":null},{"x":[42],"y":[51],"text":"Seneca","mode":"markers","marker":{"color":"rgba(140,100,175,1)","size":[11.0949995679765],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(140,100,175,1)"}},"type":"scatter","name":"Seneca","textfont":{"color":"rgba(140,100,175,1)","size":11.0949995679765},"error_y":{"color":"rgba(140,100,175,1)","width":11.0949995679765},"error_x":{"color":"rgba(140,100,175,1)","width":11.0949995679765},"line":{"color":"rgba(140,100,175,1)","width":11.0949995679765},"xaxis":"x","yaxis":"y","frame":null},{"x":[54],"y":[38],"text":"St. Lawrence","mode":"markers","marker":{"color":"rgba(122,80,164,1)","size":[13.8560977717188],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(122,80,164,1)"}},"type":"scatter","name":"St. Lawrence","textfont":{"color":"rgba(122,80,164,1)","size":13.8560977717188},"error_y":{"color":"rgba(122,80,164,1)","width":13.8560977717188},"error_x":{"color":"rgba(122,80,164,1)","width":13.8560977717188},"line":{"color":"rgba(122,80,164,1)","width":13.8560977717188},"xaxis":"x","yaxis":"y","frame":null},{"x":[48],"y":[31],"text":"Steuben","mode":"markers","marker":{"color":"rgba(109,64,154,1)","size":[13.389728401225],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(109,64,154,1)"}},"type":"scatter","name":"Steuben","textfont":{"color":"rgba(109,64,154,1)","size":13.389728401225},"error_y":{"color":"rgba(109,64,154,1)","width":13.389728401225},"error_x":{"color":"rgba(109,64,154,1)","width":13.389728401225},"line":{"color":"rgba(109,64,154,1)","width":13.389728401225},"xaxis":"x","yaxis":"y","frame":null},{"x":[7],"y":[9],"text":"Suffolk","mode":"markers","marker":{"color":"rgba(140,97,157,1)","size":[63.589419264408],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(140,97,157,1)"}},"type":"scatter","name":"Suffolk","textfont":{"color":"rgba(140,97,157,1)","size":63.589419264408},"error_y":{"color":"rgba(140,97,157,1)","width":63.589419264408},"error_x":{"color":"rgba(140,97,157,1)","width":63.589419264408},"line":{"color":"rgba(140,97,157,1)","width":63.589419264408},"xaxis":"x","yaxis":"y","frame":null},{"x":[40],"y":[59],"text":"Sullivan","mode":"markers","marker":{"color":"rgba(168,131,158,1)","size":[12.6177384049692],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(168,131,158,1)"}},"type":"scatter","name":"Sullivan","textfont":{"color":"rgba(168,131,158,1)","size":12.6177384049692},"error_y":{"color":"rgba(168,131,158,1)","width":12.6177384049692},"error_x":{"color":"rgba(168,131,158,1)","width":12.6177384049692},"line":{"color":"rgba(168,131,158,1)","width":12.6177384049692},"xaxis":"x","yaxis":"y","frame":null},{"x":[25],"y":[11],"text":"Tioga","mode":"markers","marker":{"color":"rgba(194,166,158,1)","size":[11.6664946573094],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(194,166,158,1)"}},"type":"scatter","name":"Tioga","textfont":{"color":"rgba(194,166,158,1)","size":11.6664946573094},"error_y":{"color":"rgba(194,166,158,1)","width":11.6664946573094},"error_x":{"color":"rgba(194,166,158,1)","width":11.6664946573094},"line":{"color":"rgba(194,166,158,1)","width":11.6664946573094},"xaxis":"x","yaxis":"y","frame":null},{"x":[9],"y":[3],"text":"Tompkins","mode":"markers","marker":{"color":"rgba(220,202,157,1)","size":[13.4823974424209],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(220,202,157,1)"}},"type":"scatter","name":"Tompkins","textfont":{"color":"rgba(220,202,157,1)","size":13.4823974424209},"error_y":{"color":"rgba(220,202,157,1)","width":13.4823974424209},"error_x":{"color":"rgba(220,202,157,1)","width":13.4823974424209},"line":{"color":"rgba(220,202,157,1)","width":13.4823974424209},"xaxis":"x","yaxis":"y","frame":null},{"x":[16],"y":[27],"text":"Ulster","mode":"markers","marker":{"color":"rgba(244,238,155,1)","size":[16.3959999423969],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(244,238,155,1)"}},"type":"scatter","name":"Ulster","textfont":{"color":"rgba(244,238,155,1)","size":16.3959999423969},"error_y":{"color":"rgba(244,238,155,1)","width":16.3959999423969},"error_x":{"color":"rgba(244,238,155,1)","width":16.3959999423969},"line":{"color":"rgba(244,238,155,1)","width":16.3959999423969},"xaxis":"x","yaxis":"y","frame":null},{"x":[18],"y":[16],"text":"Warren","mode":"markers","marker":{"color":"rgba(249,238,141,1)","size":[12.1914752162518],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(249,238,141,1)"}},"type":"scatter","name":"Warren","textfont":{"color":"rgba(249,238,141,1)","size":12.1914752162518},"error_y":{"color":"rgba(249,238,141,1)","width":12.1914752162518},"error_x":{"color":"rgba(249,238,141,1)","width":12.1914752162518},"line":{"color":"rgba(249,238,141,1)","width":12.1914752162518},"xaxis":"x","yaxis":"y","frame":null},{"x":[32],"y":[28],"text":"Washington","mode":"markers","marker":{"color":"rgba(236,208,120,1)","size":[12.101794337612],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(236,208,120,1)"}},"type":"scatter","name":"Washington","textfont":{"color":"rgba(236,208,120,1)","size":12.101794337612},"error_y":{"color":"rgba(236,208,120,1)","width":12.101794337612},"error_x":{"color":"rgba(236,208,120,1)","width":12.101794337612},"line":{"color":"rgba(236,208,120,1)","width":12.101794337612},"xaxis":"x","yaxis":"y","frame":null},{"x":[29],"y":[19],"text":"Wayne","mode":"markers","marker":{"color":"rgba(223,178,99,1)","size":[13.2018701817379],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(223,178,99,1)"}},"type":"scatter","name":"Wayne","textfont":{"color":"rgba(223,178,99,1)","size":13.2018701817379},"error_y":{"color":"rgba(223,178,99,1)","width":13.2018701817379},"error_x":{"color":"rgba(223,178,99,1)","width":13.2018701817379},"line":{"color":"rgba(223,178,99,1)","width":13.2018701817379},"xaxis":"x","yaxis":"y","frame":null},{"x":[1],"y":[15],"text":"Westchester","mode":"markers","marker":{"color":"rgba(208,148,78,1)","size":[43.9958213726827],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(208,148,78,1)"}},"type":"scatter","name":"Westchester","textfont":{"color":"rgba(208,148,78,1)","size":43.9958213726827},"error_y":{"color":"rgba(208,148,78,1)","width":43.9958213726827},"error_x":{"color":"rgba(208,148,78,1)","width":43.9958213726827},"line":{"color":"rgba(208,148,78,1)","width":43.9958213726827},"xaxis":"x","yaxis":"y","frame":null},{"x":[35],"y":[8],"text":"Wyoming","mode":"markers","marker":{"color":"rgba(193,119,59,1)","size":[11.3435570895057],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(193,119,59,1)"}},"type":"scatter","name":"Wyoming","textfont":{"color":"rgba(193,119,59,1)","size":11.3435570895057},"error_y":{"color":"rgba(193,119,59,1)","width":11.3435570895057},"error_x":{"color":"rgba(193,119,59,1)","width":11.3435570895057},"line":{"color":"rgba(193,119,59,1)","width":11.3435570895057},"xaxis":"x","yaxis":"y","frame":null},{"x":[24],"y":[40],"text":"Yates","mode":"markers","marker":{"color":"rgba(177,89,40,1)","size":[10.7384721728862],"sizemode":"diameter","opacity":0.5,"line":{"color":"rgba(177,89,40,1)"}},"type":"scatter","name":"Yates","textfont":{"color":"rgba(177,89,40,1)","size":10.7384721728862},"error_y":{"color":"rgba(177,89,40,1)","width":10.7384721728862},"error_x":{"color":"rgba(177,89,40,1)","width":10.7384721728862},"line":{"color":"rgba(177,89,40,1)","width":10.7384721728862},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>From the plot we can see that New York, Queens and Kings have the
highest socio economic score, but have the lowest health factors ranks.
The size of the bubble signifies total population of the county. Nassau,
Suffolk, Westcher have low health and socio-ecnomic scores.</p>
<p>Below is a colorpleth map to good understanding on the above in a
spatial context,:</p>
<pre class="r"><code>#library(sf)
#total = st_as_sf(total)
p = list()
p[[1]] = total %&gt;%
  ggplot() +
  geom_sf(aes(fill = medage, geometry = geometry)) + 
  scale_fill_viridis_c(option = &quot;viridis&quot;) 


p[[2]] = total %&gt;%
  ggplot() +
  geom_sf(aes(fill = health, geometry = geometry)) + 
  scale_fill_viridis_c(option = &quot;viridis&quot;) 

grid.arrange(p[[1]], p[[2]], nrow = 1)</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-6-1.png" width="90%" /></p>
<p>On the left we can see a chloropleth mao of medage per county in new
york on the right is a chloropleth map of health factor rank per
county.</p>
<pre class="r"><code>ny_vax =
  read_csv(&quot;./grace/ny_covidvax.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  select(-region, -series_complete) %&gt;% 
  rename(date = report_as_of) %&gt;% 
  mutate(date = lubridate::mdy(date))</code></pre>
<pre><code>## Rows: 43462 Columns: 5
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (3): Region, County, Report as of
## dbl (2): First Dose, Series Complete
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>vax_plotly =
  ny_vax %&gt;%
  filter(date == &quot;2022-11-14&quot;) %&gt;%
  mutate(county = fct_reorder(county, first_dose, .desc = TRUE)) %&gt;%
  mutate(text_label = str_c(&quot;County: &quot;, county, &quot;\nVaccinations: &quot;, first_dose)) %&gt;% 
  plot_ly(x = ~county, 
          y = ~first_dose, 
          type = &quot;bar&quot;, 
          text = ~text_label) |&gt;
          layout(xaxis = list(title = &quot;County in New York State&quot;), 
                 yaxis = list(title = &quot;Cumulative Number of People with at least one dose&quot;),          
                 title = &quot;Cumulative people with at least one dose of any COVID-19 vaccine by county by 11/14/2022&quot;)
vax_plotly</code></pre>
<div id="htmlwidget-2c198deee40c52e5c33b" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2c198deee40c52e5c33b">{"x":{"visdat":{"bb8028140459":["function () ","plotlyVisDat"]},"cur_data":"bb8028140459","attrs":{"bb8028140459":{"x":{},"y":{},"text":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"County in New York State","type":"category","categoryorder":"array","categoryarray":["Queens","Kings","New York","Nassau","Suffolk","Bronx","Westchester","Erie","Monroe","Richmond","Onondaga","Orange","Albany","Rockland","Dutchess","Saratoga","Oneida","Niagara","Ulster","Schenectady","Broome","Rensselaer","Tompkins","Ontario","Putnam","Chautauqua","Oswego","Jefferson","St. Lawrence","Wayne","Clinton","Steuben","Madison","Warren","Sullivan","Cayuga","Chemung","Columbia","Cattaraugus","Washington","Otsego","Livingston","Genesee","Herkimer","Montgomery","Greene","Chenango","Franklin","Fulton","Cortland","Essex","Delaware","Tioga","Orleans","Allegany","Wyoming","Seneca","Schoharie","Yates","Lewis","Schuyler","Hamilton"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Cumulative Number of People with at least one dose"},"title":"Cumulative people with at least one dose of any COVID-19 vaccine by county by 11/14/2022","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Albany","Allegany","Bronx","Broome","Cattaraugus","Cayuga","Chautauqua","Chemung","Chenango","Clinton","Columbia","Cortland","Delaware","Dutchess","Erie","Essex","Franklin","Fulton","Genesee","Greene","Hamilton","Herkimer","Jefferson","Kings","Lewis","Livingston","Madison","Monroe","Montgomery","Nassau","New York","Niagara","Oneida","Onondaga","Ontario","Orange","Orleans","Oswego","Otsego","Putnam","Queens","Rensselaer","Richmond","Rockland","Saratoga","Schenectady","Schoharie","Schuyler","Seneca","St. Lawrence","Steuben","Suffolk","Sullivan","Tioga","Tompkins","Ulster","Warren","Washington","Wayne","Westchester","Wyoming","Yates"],"y":[254761,23629,1225792,135771,44136,49997,82083,49607,31489,59422,46096,29855,26715,231477,718286,27955,31342,30288,37942,32436,3547,37058,75922,2097178,14516,40559,54641,587605,35501,1253189,1629986,151127,156578,369703,85604,265080,24480,79684,40618,83285,2208011,119572,392365,233540,188572,136540,19460,11283,19687,74400,56286,1240762,51306,25724,88660,148372,52448,41926,65797,884223,23493,14735],"text":["County: Albany<br />Vaccinations: 254761","County: Allegany<br />Vaccinations: 23629","County: Bronx<br />Vaccinations: 1225792","County: Broome<br />Vaccinations: 135771","County: Cattaraugus<br />Vaccinations: 44136","County: Cayuga<br />Vaccinations: 49997","County: Chautauqua<br />Vaccinations: 82083","County: Chemung<br />Vaccinations: 49607","County: Chenango<br />Vaccinations: 31489","County: Clinton<br />Vaccinations: 59422","County: Columbia<br />Vaccinations: 46096","County: Cortland<br />Vaccinations: 29855","County: Delaware<br />Vaccinations: 26715","County: Dutchess<br />Vaccinations: 231477","County: Erie<br />Vaccinations: 718286","County: Essex<br />Vaccinations: 27955","County: Franklin<br />Vaccinations: 31342","County: Fulton<br />Vaccinations: 30288","County: Genesee<br />Vaccinations: 37942","County: Greene<br />Vaccinations: 32436","County: Hamilton<br />Vaccinations: 3547","County: Herkimer<br />Vaccinations: 37058","County: Jefferson<br />Vaccinations: 75922","County: Kings<br />Vaccinations: 2097178","County: Lewis<br />Vaccinations: 14516","County: Livingston<br />Vaccinations: 40559","County: Madison<br />Vaccinations: 54641","County: Monroe<br />Vaccinations: 587605","County: Montgomery<br />Vaccinations: 35501","County: Nassau<br />Vaccinations: 1253189","County: New York<br />Vaccinations: 1629986","County: Niagara<br />Vaccinations: 151127","County: Oneida<br />Vaccinations: 156578","County: Onondaga<br />Vaccinations: 369703","County: Ontario<br />Vaccinations: 85604","County: Orange<br />Vaccinations: 265080","County: Orleans<br />Vaccinations: 24480","County: Oswego<br />Vaccinations: 79684","County: Otsego<br />Vaccinations: 40618","County: Putnam<br />Vaccinations: 83285","County: Queens<br />Vaccinations: 2208011","County: Rensselaer<br />Vaccinations: 119572","County: Richmond<br />Vaccinations: 392365","County: Rockland<br />Vaccinations: 233540","County: Saratoga<br />Vaccinations: 188572","County: Schenectady<br />Vaccinations: 136540","County: Schoharie<br />Vaccinations: 19460","County: Schuyler<br />Vaccinations: 11283","County: Seneca<br />Vaccinations: 19687","County: St. Lawrence<br />Vaccinations: 74400","County: Steuben<br />Vaccinations: 56286","County: Suffolk<br />Vaccinations: 1240762","County: Sullivan<br />Vaccinations: 51306","County: Tioga<br />Vaccinations: 25724","County: Tompkins<br />Vaccinations: 88660","County: Ulster<br />Vaccinations: 148372","County: Warren<br />Vaccinations: 52448","County: Washington<br />Vaccinations: 41926","County: Wayne<br />Vaccinations: 65797","County: Westchester<br />Vaccinations: 884223","County: Wyoming<br />Vaccinations: 23493","County: Yates<br />Vaccinations: 14735"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>From the plot created of the cumulative distribution of people who
have at-least the first dose of any COVID-19 vaccine by 11/14/2022, the
highest ranking counties are all located in three major regions of New
York State: New York City, Long Island, and Hudson Valley. Erie and
Monroe counties also have high counts and they are from Western NY and
Finger Lakes. This is expected as these are some of the most populous
counties in New York State.</p>
<pre class="r"><code>ny_death =
  read_csv(&quot;./grace/ny_coviddeaths.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;%
  rename(date = report_date, n_fatality = place_of_fatality) %&gt;% 
  mutate(date = lubridate::mdy(date)) %&gt;%
  select(-deaths_by_county_of_residence) %&gt;%
  filter(county != &quot;Statewide Total&quot;)</code></pre>
<pre><code>## Rows: 57728 Columns: 4
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (2): Report Date, County
## dbl (2): Place of Fatality, Deaths by County of Residence
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>deaths_plotly =
  ny_death %&gt;%
  filter(date == &quot;2022-11-14&quot;) %&gt;%
  mutate(county = fct_reorder(county, n_fatality, .desc = TRUE)) %&gt;% 
  mutate(text_label = str_c(&quot;County: &quot;, county, &quot;\nDeaths: &quot;, n_fatality)) %&gt;% 
  plot_ly(x = ~county, 
          y = ~n_fatality, 
          type = &quot;bar&quot;, 
          text = ~text_label) |&gt;
          layout(xaxis = list(title = &quot;County in New York State&quot;), 
                 yaxis = list(title = &quot;Cumulative Number of Fatalities&quot;),          
                 title = &quot;Cumulative COVID-19 deaths by county by 11/14/2022&quot;)
deaths_plotly</code></pre>
<div id="htmlwidget-ddb6864f0d3069ab2d04" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ddb6864f0d3069ab2d04">{"x":{"visdat":{"bb805cb0171":["function () ","plotlyVisDat"]},"cur_data":"bb805cb0171","attrs":{"bb805cb0171":{"x":{},"y":{},"text":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"County in New York State","type":"category","categoryorder":"array","categoryarray":["Kings","Queens","Manhattan","Nassau","Bronx","Suffolk","Westchester","Erie","Monroe","Richmond","Onondaga","Orange","Albany","Rockland","Oneida","Dutchess","Broome","Niagara","Chemung","Schenectady","Chautauqua","Saratoga","Ontario","Cattaraugus","Rensselaer","Warren","Ulster","Steuben","Montgomery","St. Lawrence","Columbia","Genesee","Otsego","Clinton","Cayuga","Jefferson","Madison","Oswego","Putnam","Wayne","Cortland","Fulton","Tompkins","Sullivan","Allegany","Livingston","Chenango","Herkimer","Wyoming","Orleans","Tioga","Washington","Essex","Seneca","Greene","Franklin","Delaware","Yates","Lewis","Schoharie","Schuyler","Hamilton","Non-NYS"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Cumulative Number of Fatalities"},"title":"Cumulative COVID-19 deaths by county by 11/14/2022","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Albany","Allegany","Bronx","Broome","Cattaraugus","Cayuga","Chautauqua","Chemung","Chenango","Clinton","Columbia","Cortland","Delaware","Dutchess","Erie","Essex","Franklin","Fulton","Genesee","Greene","Hamilton","Herkimer","Jefferson","Kings","Lewis","Livingston","Madison","Manhattan","Monroe","Montgomery","Nassau","Niagara","Non-NYS","Oneida","Onondaga","Ontario","Orange","Orleans","Oswego","Otsego","Putnam","Queens","Rensselaer","Richmond","Rockland","Saratoga","Schenectady","Schoharie","Schuyler","Seneca","St. Lawrence","Steuben","Suffolk","Sullivan","Tioga","Tompkins","Ulster","Warren","Washington","Wayne","Westchester","Wyoming","Yates"],"y":[1031,95,4937,677,249,129,315,323,76,158,174,110,28,758,3146,40,34,107,173,37,0,73,127,8408,21,88,127,6361,2074,199,5023,402,0,877,1412,261,1115,59,127,160,117,7014,245,1470,908,275,323,16,8,38,193,212,4691,103,42,105,215,242,42,114,3156,72,26],"text":["County: Albany<br />Deaths: 1031","County: Allegany<br />Deaths: 95","County: Bronx<br />Deaths: 4937","County: Broome<br />Deaths: 677","County: Cattaraugus<br />Deaths: 249","County: Cayuga<br />Deaths: 129","County: Chautauqua<br />Deaths: 315","County: Chemung<br />Deaths: 323","County: Chenango<br />Deaths: 76","County: Clinton<br />Deaths: 158","County: Columbia<br />Deaths: 174","County: Cortland<br />Deaths: 110","County: Delaware<br />Deaths: 28","County: Dutchess<br />Deaths: 758","County: Erie<br />Deaths: 3146","County: Essex<br />Deaths: 40","County: Franklin<br />Deaths: 34","County: Fulton<br />Deaths: 107","County: Genesee<br />Deaths: 173","County: Greene<br />Deaths: 37","County: Hamilton<br />Deaths: 0","County: Herkimer<br />Deaths: 73","County: Jefferson<br />Deaths: 127","County: Kings<br />Deaths: 8408","County: Lewis<br />Deaths: 21","County: Livingston<br />Deaths: 88","County: Madison<br />Deaths: 127","County: Manhattan<br />Deaths: 6361","County: Monroe<br />Deaths: 2074","County: Montgomery<br />Deaths: 199","County: Nassau<br />Deaths: 5023","County: Niagara<br />Deaths: 402","County: Non-NYS<br />Deaths: 0","County: Oneida<br />Deaths: 877","County: Onondaga<br />Deaths: 1412","County: Ontario<br />Deaths: 261","County: Orange<br />Deaths: 1115","County: Orleans<br />Deaths: 59","County: Oswego<br />Deaths: 127","County: Otsego<br />Deaths: 160","County: Putnam<br />Deaths: 117","County: Queens<br />Deaths: 7014","County: Rensselaer<br />Deaths: 245","County: Richmond<br />Deaths: 1470","County: Rockland<br />Deaths: 908","County: Saratoga<br />Deaths: 275","County: Schenectady<br />Deaths: 323","County: Schoharie<br />Deaths: 16","County: Schuyler<br />Deaths: 8","County: Seneca<br />Deaths: 38","County: St. Lawrence<br />Deaths: 193","County: Steuben<br />Deaths: 212","County: Suffolk<br />Deaths: 4691","County: Sullivan<br />Deaths: 103","County: Tioga<br />Deaths: 42","County: Tompkins<br />Deaths: 105","County: Ulster<br />Deaths: 215","County: Warren<br />Deaths: 242","County: Washington<br />Deaths: 42","County: Wayne<br />Deaths: 114","County: Westchester<br />Deaths: 3156","County: Wyoming<br />Deaths: 72","County: Yates<br />Deaths: 26"],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>From the plot created of the cumulative distribution of people who
have died from COVID-19 by 11/14/2022, the highest ranking counties are
also all located in three major regions of New York State: New York
City, Long Island, and Hudson Valley, along with Erie and Monroe
counties from Western NY and Finger Lakes. Again, this is expected as
these are some of the most populous counties in New York State.</p>
</div>
<div id="statistical-analysis" class="section level2">
<h2>Statistical Analysis</h2>
<p>Note: Though we initially planned to adjust for racial diversity in
our model, the variable was removed because racial diversity index did
not vary much among counties. For each model, only data from 2021 was
used because there is no information on 2020 vaccination as the vaccine
was developed in 2021 and 2022 data is incomplete.</p>
<p style="color: red">
<strong><em>Question 1: Which health factors are associated with
COVID-19?</em></strong>
</p>
<p>Health factors – health behaviors, clinical care, physical
environment, and socioeconomic factors – are community conditions that
can be modified and improved through public health interventions or
health policies. Therefore, we were interested in seeing which factor(s)
is significantly associated with the number of COVID-19 cases, COVID-19
deaths, and COVID-19 vaccination. To do so, we ran multiple linear
regression test.</p>
<p><strong>Model 1</strong>
<img src="images/model1.png" style="width:100%"></p>
<pre class="r"><code>m1 = comb %&gt;% 
  filter(year == &#39;2021&#39;) %&gt;% 
  lm(n_cases ~ health_beh_r + clinical_care_r + env_r + ses_r + longevity_r + qol_r + medage, data = .)

m1 %&gt;% 
  broom::tidy() %&gt;% 
  select(term, estimate, p.value) %&gt;% 
  knitr::kable(digits = 3) </code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">281132.339</td>
<td align="right">0.003</td>
</tr>
<tr class="even">
<td align="left">health_beh_r</td>
<td align="right">-3135.730</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">clinical_care_r</td>
<td align="right">1016.997</td>
<td align="right">0.042</td>
</tr>
<tr class="even">
<td align="left">env_r</td>
<td align="right">318.977</td>
<td align="right">0.443</td>
</tr>
<tr class="odd">
<td align="left">ses_r</td>
<td align="right">1519.072</td>
<td align="right">0.015</td>
</tr>
<tr class="even">
<td align="left">longevity_r</td>
<td align="right">-1073.673</td>
<td align="right">0.077</td>
</tr>
<tr class="odd">
<td align="left">qol_r</td>
<td align="right">721.774</td>
<td align="right">0.179</td>
</tr>
<tr class="even">
<td align="left">medage</td>
<td align="right">-5461.353</td>
<td align="right">0.014</td>
</tr>
</tbody>
</table>
<p>After adjusting for median age and health outcome variables, health
behaviors, clinical care, and SES factors were shown to be significantly
associated with COVID-19 incidence (p &lt; .05). Health behaviors score
is based on the community residents’ tobacco use, diet &amp; exercise,
alcohol &amp; drug use, and sexual activity (i.e., number of STI/STD).
Lelve of clinical care is determined by access to care and quality of
care. Lastly, SES factors are comprised of education, employment,
income, family &amp; social support, and community safety. Since factors
such as unequal access to healthcare, high-quality education, increased
use of drug and alcohol, etc. are well-known, potential drivers of
health inequity. The results warrant further exploration of interaction
between these factors and race/ethnicity.</p>
<p>To test the validity of our results, we checked regression
assumptions.</p>
<pre class="r"><code>plot(m1)</code></pre>
<p><img src="Final-Report_files/figure-html/m1_check-1.png" width="90%" /><img src="Final-Report_files/figure-html/m1_check-2.png" width="90%" /><img src="Final-Report_files/figure-html/m1_check-3.png" width="90%" /><img src="Final-Report_files/figure-html/m1_check-4.png" width="90%" /></p>
<p>The residual vs. fitted plot does not show strong pattern; however,
the points are not perfectly, randomly scattered around residual = 0.
The residual vs. leverage plot confirms that our model does not have any
influential points because no point falls outside Cook’s distance.
Meanwhile, scale-location plot indicates a potential violation of
heteroscedasticity. Lastly, for the normal Q-Q plot, there appears to be
no extreme skewness with majority of the points falling along the line.
Some deviations at the lowest and highest quantiles suggest that random
fluctuation may be seen at extreme ends. Therefore, these plots indicate
that our model, though sufficient, can be improved (i.e., add
interaction terms, adjust for more variables) and there is more to be
explored.</p>
<p><strong>Model 2</strong>
<img src="images/model2.png" style="width:100%"></p>
<pre class="r"><code>m2 = comb %&gt;% 
  filter(year == &#39;2021&#39;) %&gt;% 
  lm(n_deaths ~ health_beh_r + clinical_care_r + env_r + longevity_r + qol_r + medage, data = .)

m2 %&gt;% 
  broom::tidy() %&gt;% 
  select(term, estimate, p.value) %&gt;% 
  knitr::kable(digits = 3) </code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">6350.926</td>
<td align="right">0.002</td>
</tr>
<tr class="even">
<td align="left">health_beh_r</td>
<td align="right">-56.095</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">clinical_care_r</td>
<td align="right">23.376</td>
<td align="right">0.027</td>
</tr>
<tr class="even">
<td align="left">env_r</td>
<td align="right">3.849</td>
<td align="right">0.666</td>
</tr>
<tr class="odd">
<td align="left">longevity_r</td>
<td align="right">-15.743</td>
<td align="right">0.224</td>
</tr>
<tr class="even">
<td align="left">qol_r</td>
<td align="right">27.562</td>
<td align="right">0.012</td>
</tr>
<tr class="odd">
<td align="left">medage</td>
<td align="right">-124.994</td>
<td align="right">0.010</td>
</tr>
</tbody>
</table>
<p>As seen with model 1, model 2 indicates that all health factors
except physical environment are significantly associated with number of
deaths related to COVID-19 in each county (p &lt; .05). Since physical
environment score is based on air/water quality and housing/transit
conditions within the county, this suggests that public health
professionals can aim to mitigate disparities in COVID-19 by first
starting short-term community-based public health interventions aimed at
encouraging residents to building healthier lifestyles.</p>
<pre class="r"><code>plot(m2)</code></pre>
<p><img src="Final-Report_files/figure-html/m2_check-1.png" width="90%" /><img src="Final-Report_files/figure-html/m2_check-2.png" width="90%" /><img src="Final-Report_files/figure-html/m2_check-3.png" width="90%" /><img src="Final-Report_files/figure-html/m2_check-4.png" width="90%" /></p>
<p>Results of regression assumption tests were also similar to that of
model 1’s, indicating that there is more to be explored in the
association between health factor and COVID-19 fatalities.</p>
<p><strong>Model 3</strong>
<img src="images/model3.png" style="width:100%"></p>
<pre class="r"><code>m3 = comb %&gt;% 
  filter(year == &#39;2021&#39;) %&gt;% 
  lm(vax_dose1 ~ health_beh_r + clinical_care_r + env_r + ses_r + longevity_r + qol_r + medage, data = .,)

m3 %&gt;% 
  broom::tidy() %&gt;% 
  select(term, estimate, p.value) %&gt;% 
  knitr::kable(digits = 3) </code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1680734.061</td>
<td align="right">0.003</td>
</tr>
<tr class="even">
<td align="left">health_beh_r</td>
<td align="right">-18570.509</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">clinical_care_r</td>
<td align="right">5547.020</td>
<td align="right">0.061</td>
</tr>
<tr class="even">
<td align="left">env_r</td>
<td align="right">1458.937</td>
<td align="right">0.553</td>
</tr>
<tr class="odd">
<td align="left">ses_r</td>
<td align="right">8341.958</td>
<td align="right">0.023</td>
</tr>
<tr class="even">
<td align="left">longevity_r</td>
<td align="right">-6378.192</td>
<td align="right">0.076</td>
</tr>
<tr class="odd">
<td align="left">qol_r</td>
<td align="right">4723.999</td>
<td align="right">0.138</td>
</tr>
<tr class="even">
<td align="left">medage</td>
<td align="right">-31869.647</td>
<td align="right">0.016</td>
</tr>
</tbody>
</table>
<p>Unlike models 1 and 2, model 3 indicates that neither clinical care
nor physical environment scores are significantly associated with the
rate of COVID vaccination (p &gt; .05). This can potentailly be because
the COVID vaccine was available not only at hospitals but also at
locations such pharmacies (CVS, Walgreen, etc.) and community health
centers, removing the barrier to healthcare access. Meanwhile,
significant associations with health behaviors and SES factors (p &lt;
.05) reinforce the need to address root causes of health inequity such
as residential segregation.</p>
<pre class="r"><code>plot(m3)</code></pre>
<p><img src="Final-Report_files/figure-html/m3_check-1.png" width="90%" /><img src="Final-Report_files/figure-html/m3_check-2.png" width="90%" /><img src="Final-Report_files/figure-html/m3_check-3.png" width="90%" /><img src="Final-Report_files/figure-html/m3_check-4.png" width="90%" /></p>
<p>Regression assumption tests, once again, show room for improvement in
our model and the need for further analysis</p>
<p style="color: red">
<strong><em>Question 2: Can SES factors and race/ethnicity alone predict
COVID-19 vaccination or fatalities?</em></strong>
</p>
<p><strong>Model 4</strong>
<img src="images/model4.png" style="width:100%"></p>
<pre class="r"><code>m4 = comb %&gt;% 
  filter(year == &#39;2021&#39;)

m4 = comb %&gt;% 
  filter(year == &#39;2021&#39;) %&gt;% 
  glm(vax_maj ~ segregation + p_minority + median_income + medage, data = .)

summary(m4)</code></pre>
<pre><code>## 
## Call:
## glm(formula = vax_maj ~ segregation + p_minority + median_income + 
##     medage, data = .)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.41979  -0.09293  -0.00468   0.03441   0.88464  
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   -6.704e-01  5.234e-01  -1.281  0.20554   
## segregation    2.841e-02  7.986e-02   0.356  0.72342   
## p_minority     5.541e-03  2.702e-03   2.051  0.04497 * 
## median_income  6.314e-06  2.073e-06   3.045  0.00354 **
## medage         6.129e-03  1.237e-02   0.495  0.62219   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 0.05758436)
## 
##     Null deviance: 4.5902  on 60  degrees of freedom
## Residual deviance: 3.2247  on 56  degrees of freedom
##   (1 observation deleted due to missingness)
## AIC: 5.7689
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<pre class="r"><code>m4 %&gt;% 
  broom::tidy() %&gt;% 
  mutate(OR = exp(estimate),
         OR_CI_lower = exp(estimate - 1.96*(std.error)),
         OR_CI_upper = exp(estimate + 1.96*(std.error))) %&gt;% 
  select(term, log_OR = estimate, OR, OR_CI_lower, OR_CI_upper, p.value) %&gt;% 
  knitr::kable(digits = 5)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">log_OR</th>
<th align="right">OR</th>
<th align="right">OR_CI_lower</th>
<th align="right">OR_CI_upper</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.67042</td>
<td align="right">0.51149</td>
<td align="right">0.18335</td>
<td align="right">1.42691</td>
<td align="right">0.20554</td>
</tr>
<tr class="even">
<td align="left">segregation</td>
<td align="right">0.02841</td>
<td align="right">1.02881</td>
<td align="right">0.87974</td>
<td align="right">1.20315</td>
<td align="right">0.72342</td>
</tr>
<tr class="odd">
<td align="left">p_minority</td>
<td align="right">0.00554</td>
<td align="right">1.00556</td>
<td align="right">1.00025</td>
<td align="right">1.01090</td>
<td align="right">0.04497</td>
</tr>
<tr class="even">
<td align="left">median_income</td>
<td align="right">0.00001</td>
<td align="right">1.00001</td>
<td align="right">1.00000</td>
<td align="right">1.00001</td>
<td align="right">0.00354</td>
</tr>
<tr class="odd">
<td align="left">medage</td>
<td align="right">0.00613</td>
<td align="right">1.00615</td>
<td align="right">0.98205</td>
<td align="right">1.03084</td>
<td align="right">0.62219</td>
</tr>
</tbody>
</table>
<p>Based on the the results, the odds of getting the first dose of the
COVID vaccine do not differ significantly between counties with low
level of segregation and moderate/high level of segregation. Ironically,
for every 1% increase in % minority, the odds of the county’s resident
receiving the first dose of the vaccine increases by 1.006 times (p =
.045). This could’ve occurred because the model lacks an adequate
adjustment for race/ethnicity. Meanwhile, the model also shows that for
every $1 increase in median household income, the odds of the county’s
resident receiving dose 1 of the vaccine increases by 1.006 times (p =
.003).</p>
<p>Upon checking our model,</p>
<pre class="r"><code>plot(m4)</code></pre>
<p><img src="Final-Report_files/figure-html/m4_check-1.png" width="90%" /><img src="Final-Report_files/figure-html/m4_check-2.png" width="90%" /><img src="Final-Report_files/figure-html/m4_check-3.png" width="90%" /><img src="Final-Report_files/figure-html/m4_check-4.png" width="90%" />
we did see the need to adjust our model; however, with the lack of 2021
data and demographics information, further analysis and modifications
could not be completed. The residual vs. fitted plot did not give us
much information as the outcome variable of our model is binary. The
normal Q-Q plot showed that our data is not skewed, though there are
some deviations at extreme quantiles. Furthermore, there appears to be
potentially heteroscedasticity per scale-location plot and one outlier
(point #3 falls outside Cook’s distance).</p>
<p><strong>Model 5</strong>
<img src="images/model5.png" style="width:100%"></p>
<pre><code>## 
## Call:
## lm(formula = n_deaths ~ segregation_score + p_minority + median_income + 
##     medage, data = .)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1806.4  -461.1    -5.6   305.5  3378.0 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -1.195e+03  2.064e+03  -0.579   0.5650    
## segregation_score  1.561e+01  1.067e+01   1.463   0.1490    
## p_minority         7.352e+01  1.068e+01   6.882 5.42e-09 ***
## median_income      1.452e-02  8.070e-03   1.799   0.0775 .  
## medage            -1.490e+01  4.789e+01  -0.311   0.7568    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 934.4 on 56 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.6687, Adjusted R-squared:  0.645 
## F-statistic: 28.26 on 4 and 56 DF,  p-value: 7.271e-13</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-1194.714</td>
<td align="right">0.565</td>
</tr>
<tr class="even">
<td align="left">segregation_score</td>
<td align="right">15.607</td>
<td align="right">0.149</td>
</tr>
<tr class="odd">
<td align="left">p_minority</td>
<td align="right">73.524</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">median_income</td>
<td align="right">0.015</td>
<td align="right">0.077</td>
</tr>
<tr class="odd">
<td align="left">medage</td>
<td align="right">-14.903</td>
<td align="right">0.757</td>
</tr>
</tbody>
</table>
<p>This model shows the number of COVID-19 fatalities in each county is
significantly associated with it’s % minority (p &lt; .05), confirming
that racial/ethnic minorities, specifically Hispanic and Black, had a
higher risk of dying from COVID compared to White/Asian. AIAN &amp;
NHOPI were not included because they constitute only ~1% of population
for each county.</p>
<pre class="r"><code>plot(m5)</code></pre>
<p><img src="Final-Report_files/figure-html/m5_check-1.png" width="90%" /><img src="Final-Report_files/figure-html/m5_check-2.png" width="90%" /><img src="Final-Report_files/figure-html/m5_check-3.png" width="90%" /><img src="Final-Report_files/figure-html/m5_check-4.png" width="90%" /></p>
<p>For regression test plots, the conclusions are very similar to that
of model 4’s. The residual vs. Fitted model shows no clean patterns;
however, the points are also not equally, randomly distributed along
residual = 0 line. The Q-Q plot confirms our data is normally
distributed with no extreme skewness. Scale-location shows possibility
of homoscedasticity violation and residual vs. leverage, shows that
point #3 is an influential point; combined with model 4’s leverage plot,
this indicates the need to remove point #3 from our models.</p>
</div>
<div id="spatial-analysis" class="section level1">
<h1>Spatial Analysis</h1>
<pre class="r"><code>ny_covid = read.csv(&#39;data/covid_testing.csv&#39;)  %&gt;%
  janitor::clean_names()

###############################
ny_covid$test_date = lubridate::mdy(ny_covid$test_date)
##############################
total &lt;- merge(ny_covid,NY_df,by=&quot;county&quot;)</code></pre>
<pre class="r"><code>mon = seq(as.Date(&quot;2021-01-01&quot;), as.Date(&quot;2022-01-01&quot;), by = &quot;3 months&quot;)
df_list = list()
# loop version 2
for (i in 1:4) {
  sub_df = total[total$test_date &gt;= mon[[i]] &amp; total$test_date &lt;= mon[[i+1]], ]
  group_df =  sub_df %&gt;% group_by(county)  %&gt;%
    summarise(total_covid = sum(new_positives))
  df = dplyr :: left_join(group_df, NY_df, by = &#39;county&#39;)
  df_list[[i]] = df
}


p &lt;- list()
for(i in 1:4){
  p[[i]] &lt;- df_list[[i]] %&gt;%
    ggplot() +geom_sf(aes(fill = total_covid, geometry = geometry)) + 
    scale_fill_viridis_c(option = &quot;viridis&quot;) 
}

do.call(grid.arrange,p)</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-14-1.png" width="90%" />
The above 4 chloroplast maps are a summary</p>
</div>
<div id="autoregression" class="section level1">
<h1>Autoregression</h1>
<pre class="r"><code>ny_covid = read.csv(&#39;data/covid_testing.csv&#39;)  %&gt;%
  janitor::clean_names()

######################################################
ny_covid$test_date = lubridate::mdy(ny_covid$test_date)
sub_df = ny_covid[ny_covid$county == &#39;New York City&#39;, ]
sub_df&lt;- sub_df[seq(dim(sub_df)[1],1),]

# basic scatterplot
ggplot(sub_df, aes(x=test_date, y=new_positives)) + 
  geom_point(alpha = 10/100, colour = &quot;red&quot;) + 
  scale_x_date(date_labels = &quot;%m-%Y&quot;) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  labs(title = &quot;New positives per month in NYC&quot;)</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-15-1.png" width="90%" />
The above plot is a scatter plot of the daily positive cases in New York
City from March 2020 up-till now. We can see the wave like trend,
especially from hill shaped curves at the start of the 2020, start of
2021, start of 2022 when it peaked around mid 2022. This implies the
existence of auto regressive behavior which we were interested to
investigate. To better understand the auto-regressive trend we built a
Autocorrelation Function (ACF) plot and Partial Autocorrelation Function
(PACF) plot. The ACF and PACF plots are used to figure out the order of
AR, MA, and ARMA models. Autocorrelation is the correlation between a
time series with a lagged version. The partial autocorrelation at lag k
is the autocorrelation between X_t_t and X_(t-k) that is not accounted
for by lags 1 through 𝑘−1.</p>
<pre class="r"><code>library(forecast)</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;forecast&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:nlme&#39;:
## 
##     getResponse</code></pre>
<pre class="r"><code>library(ggplot2)

conf.level &lt;- 0.95
ciline &lt;- qnorm((1 - conf.level)/2)/sqrt(length(sub_df$new_positives))

############# ACF ####################
bacf &lt;- acf(sub_df$new_positives, plot = FALSE)
bacfdf &lt;- with(bacf, data.frame(lag, acf))

p1 &lt;- ggplot(data=bacfdf, mapping=aes(x=lag, y=acf)) +
       geom_bar(stat = &quot;identity&quot;, position = &quot;identity&quot;)


########### PACF ###################
bacf &lt;- pacf(sub_df$new_positives, plot = FALSE)
bacfdf &lt;- with(bacf, data.frame(lag, acf))


p2 &lt;- ggplot(data=bacfdf, mapping=aes(x=lag, y=acf)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;identity&quot;,fill=&quot;lightblue&quot;)  

grid.arrange(p1,p2)</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-16-1.png" width="90%" />
Both the ACF and PACF start with a lag of 0, which is the correlation of
the time series with itself and therefore results in a correlation of 1.
However after a lag of 1, ACF gives us values of auto-correlation of any
series with its lagged values whereas PACF finds correlation of the
residuals that remains after removing the effects which are already
explained by the earlier lag(s). Thus PACF might be a better indicator
of how many lag terms to keep. In our case we decided to move with the 8
lag terms since they seem to have significant partial autcorrelation
with value at lag = 0 (present value).</p>
<pre class="r"><code>reg1 = arima(sub_df$new_positives, order = c(8,0,0))
summary(reg1)</code></pre>
<pre><code>## 
## Call:
## arima(x = sub_df$new_positives, order = c(8, 0, 0))
## 
## Coefficients:
##          ar1      ar2     ar3     ar4      ar5     ar6     ar7      ar8
##       1.0562  -0.2312  0.0948  0.0779  -0.1035  0.1343  0.3918  -0.4517
## s.e.  0.0283   0.0421  0.0425  0.0425   0.0424  0.0424  0.0420   0.0282
##       intercept
##        2924.354
## s.e.   1117.515
## 
## sigma^2 estimated as 1259656:  log likelihood = -8351.82,  aic = 16723.63
## 
## Training set error measures:
##                     ME     RMSE      MAE  MPE MAPE      MASE       ACF1
## Training set 0.7579743 1122.344 505.0917 -Inf  Inf 0.9324851 -0.1255802</code></pre>
<p>The coefficients for an AR(8) model represent the weights that are
applied to the past 8 values of the time series (i.e. <span
class="math inline">\(y_{t-1}\)</span>, <span
class="math inline">\(y_{t-2}\)</span>, <span
class="math inline">\(y_{t-3}\)</span>, <span
class="math inline">\(y_{t-4}\)</span>, <span
class="math inline">\(y_{t-5}\)</span>, <span
class="math inline">\(y_{t-6}\)</span>, <span
class="math inline">\(y_{t-7}\)</span>, <span
class="math inline">\(y_{t-8}\)</span>) in order to predict the next
value of the time series (<span
class="math inline">\(\hat{y}_t\)</span>). In this case, the
coefficients are as follows:</p>
<p>These coefficients can be used to write the ARIMA (8,0,0) equation as
follows:</p>
<p><span class="math inline">\(\hat{y}t = \alpha_1 y{t-1} + \alpha_2
y_{t-2} + \alpha_3 y_{t-3} + \alpha_4 y_{t-4} + \alpha_5 y_{t-5} +
\alpha_6 y_{t-6} + \alpha_7 y_{t-7} + \alpha_8 y_{t-8} +
\beta_0\)</span></p>
<p><span class="math inline">\(\begin{aligned} \hat{y}t &amp;= 1.0562
\cdot y_{t-1} - 0.2312 \cdot y_{t-2} + 0.0948 \cdot y_{t-3} + 0.0779
\cdot y_{t-4} - 0.1035 \cdot y_{t-5} + 0.1343 \cdot y_{t-6} + 0.3918
\cdot y_{t-7} - 0.4517 \cdot y_{t-8} + 2924.354
\end{aligned}\)</span></p>
<p>This equation can be used to predict the next value of the time
series, <span class="math inline">\(\hat{y}_t\)</span>, based on the
past 8 values of the time series. The coefficients in the equation
represent the relative importance of each of the past values in
predicting the next value.</p>
<p>Plotting the fitted values alongside the positive covid cases:</p>
<pre class="r"><code>ar = fitted(reg1)
ggplot(sub_df, aes(x=test_date, y=new_positives)) + 
  geom_point(alpha = 20/100, color = &quot;red&quot;) + 
  scale_x_date(date_labels = &quot;%m-%Y&quot;,date_breaks = &quot;1 month&quot;) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  labs(title = &quot;Scatter Plot of Daily Postive Cases in New York City from 2020-2022
       with ARIMA trend line&quot;, x= &quot;Test Date&quot;,
       y = &#39;Positive Cases Detected&#39;) +
  geom_line(aes(y=ar,color = &quot;ARIMA trend line&quot;)) +  
  scale_color_manual(values = c(&quot;ARIMA trend line&quot; = &quot;black&quot;),
                                          labels = &quot;Fitted Arima Model&quot;)</code></pre>
<p><img src="Final-Report_files/figure-html/unnamed-chunk-18-1.png" width="90%" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
