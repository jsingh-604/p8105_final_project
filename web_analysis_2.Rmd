---
title: "Socieconomic Factors, Race/Ethnicity and COVID Outbreak"
output: 
  html_document:
    code_folding: hide
    toc: true
    toc_float: true
    toc_depth: 4
    theme: lumen
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(kableExtra)

source("code/data_cleaning.R")
```

## Socioeconomic Factors, Race/Ethnicity and Covid

### COVID Vaccination Rate

$Vaccination \sim \beta_{0} + \beta_{1} Segregation\_Score + \beta_{2} Median\_Income + \beta_{3} Percent\_Minority + \beta_{4} Population\_Density + \epsilon$

where vax_maj = 1, then more than 83% received dose 1 of the vaccine, vax_maj = 2, then less than 83% received dose 1 of the vaccine

```{r}
m4 = comb %>% 
  filter(year == '2022') %>% 
  glm(vax_maj ~ segregation_score + median_income + p_minority 
      + pop_d, data = .)

m4 %>% 
  broom::tidy() %>% 
  mutate(OR = exp(estimate),
         OR_CI_lower = exp(estimate - 1.96*(std.error)),
         OR_CI_upper = exp(estimate + 1.96*(std.error))) %>% 
  select(term, log_OR = estimate, OR, OR_CI_lower, OR_CI_upper, p.value) %>% 
  kbl(
    caption = "Socioeconomic Factors & COVID Vaccination"
    , col.names = c("Predictor", "Estimate", "OR", "OR CI, low", "OR CI, high", "p-value")
    , digits = 5) %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"))
```

After adjusting for population density, among the socioeconomic factors in the model, median income and % minority (Black and Hispanic) are statistically significant (p < .05).

### COVID Fatalities

$N_{Deaths} \sim \beta_{0} + \beta_{1} Segregation\_Score + \beta_{2} Percent\_Minority + \beta_{3} Median\_Income + \beta_{4} Median\_Age + \beta_{5} Population\_Density + \epsilon$

```{r}
m5 = comb %>% 
  filter(year == '2021') %>% 
  lm(n_deaths ~ segregation_score + p_minority + median_income + medage 
     + pop_d, data = .)

m5 %>% 
  broom::tidy() %>%
  select(term, estimate, p.value) %>% 
  kbl(
    caption = "Socioeconomic Factors & COVID Deaths"
    , col.names = c("Predictor", "Estimate", "p-value")
    , digits = 3) %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"))
```

Adjusting for median age and population density, segregation score, median income and % minority (Black and Hispanic) are significantly associated with the number of COVID deaths (p <= .05).