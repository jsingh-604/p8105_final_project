---
title: "County Health Factors Ranking & COVID-19 Analysis"
output: html_document
html_document:
  code_folding: hide
  toc: true
  toc_float: true
  theme: cosmo
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(kableExtra)

source("code/data_cleaning.R")
```

### County Health Factors and COVID-19

In the data visualization for HF and COVID-19, we observe patterns across all three COVID-19 variables: fatalities, cases, and vaccination for only health behaviors. Therefore, we decided to explore this further and test whether this holds true even after adjusting for population density and median age, which were often shown to be strongly correlated and/or associated with COVID-19.

#### County Health Factors and Number of COVID Cases

First, we tested for association among HF (health behavior, clinical care, physical environment, and socioeconomic factors) crankings (health b) and COVID-19 cases after adjusting for median age and population density in each county. 

```{r, message = FALSE, warning = FALSE}
m1 = comb %>% 
  filter(year == '2021') %>% 
  lm(n_cases ~ health_beh_r + clinical_care_r + env_r + ses_r + medage + 
       pop_d, data = .)

m1 %>% 
  broom::tidy() %>%
  select(term, estimate, p.value) %>% 
  kbl(
    caption = "Health Factor Ranking & COVID Outbreak"
    , col.names = c("Predictor", "Estimate", "p-value")
    , digits = 3) %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"))
```

Among the 4 factors, only health behaviors ranking's p-value is < .05, indicating that health behaviors ranking is significantly associated with the number of COVID cases.

#### County Health Factors and Number of COVID Deaths

```{r}
m2 = comb %>% 
  filter(year == '2021') %>% 
  lm(n_deaths ~ health_beh_r + clinical_care_r + env_r + ses_r + pop_d + medage, data = .)

m2 %>% 
broom::tidy() %>%
  select(term, estimate, p.value) %>% 
  kbl(
    caption = "Health Factor Ranking & COVID Deaths"
    , col.names = c("Predictor", "Estimate", "p-value")
    , digits = 3) %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"))
```

#### County Health Factors and Number of COVID Vaccination

```{r}

```


